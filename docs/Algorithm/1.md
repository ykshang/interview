# 发布/订阅模式

## 1. 什么是发布订阅模式

发布订阅模式是一种消息范式，涉及消息的发送者（称为**发布者**）和接收者（称为**订阅者**）。在这种模式中，发布者和订阅者不直接相互了解，而是通过一个称为"**事件通道**"或"消息代理"的中间人来管理消息的分发。

这种模式提供了更好的程序解耦，增强了程序的可扩展性和可维护性。它是一种对象间一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知。

**现实生活中的例子：**

- 报纸订阅：读者（订阅者）订阅报纸，出版社（发布者）通过邮局（事件通道）发送报纸。
- 电子邮件列表：用户订阅感兴趣的主题，当有新内容时，系统自动发送邮件给所有订阅者。
- 社交媒体：用户关注某个主题或人物，平台在有更新时推送通知。
- 股票市场：投资者订阅特定股票的价格变动，当价格变化时，系统通知所有订阅该股票的投资者。

在 JavaScript 中，发布订阅模式常用于处理异步操作和事件驱动编程，特别是在前端开发中。它是实现松耦合、可扩展系统的重要工具。

## 2. 发布订阅模式的核心概念

发布订阅模式主要包含三个核心角色：

- 发布者（Publisher）：负责创建消息，但不直接发送给订阅者。

- 订阅者（Subscriber）：对特定消息感兴趣的对象，只接收感兴趣的消息。

- 事件通道（Event Channel）：连接发布者和订阅者的中介，管理订阅关系并分发消息。

除了这三个核心角色，还有一些重要的概念：

- 主题（Topic）：消息的分类或频道，订阅者可以订阅特定的主题。
- 消息（Message）：从发布者传递到订阅者的信息载体。
- 回调函数（Callback）：订阅者提供的函数，在接收到消息时被调用。

#### 发布订阅模式的工作流程

1. 订阅者通过事件通道订阅特定类型的消息。
2. 发布者创建消息并发送到事件通道。
3. 事件通道将消息分发给所有相关的订阅者。
4. 订阅者接收并处理消息。

```sequence
  发布者->>事件通道: publish
  事件通道->>订阅者: notify
  发布者->>事件通道: publish
  事件通道->>订阅者: notify
```
 