# Vue 的组件通信

## 1. prop属性 <Badge text="父传子" type="tip" vertical="top"/>

通过 prop 属性，可以实现父组件向子组件传递信息

#### 父组件

  ```Vue
  <template>
    <div>
      <!-- 传递值 -->
      <Test :obj="obj" info="测试"/> 
    </div>
  </template>

  <script>
  import Test from "../components/Test.vue"; // 引入子组件
  export default {
    name: "about",
    components: { Test }, // 注册子组件
    data() {
      return {
        obj: {
          code: 200,
          title: "父组件传值title",
        },
      };
    },
  };
  </script>
  ```

#### 子组件

  ```Vue
  <template>
      <div>
          <h1>{{obj.code}}</h1><br>
          <h2>{{obj.title}}</h2>
          <h3>{{info}}</h3>
      </div>
  </template>

  <script>
      export default {
          name:'test',
          props:{
              obj:Object,
              info: [String,Number]  //info值为其中一种类型即可，其他类型报警告
          }
      }
  </script>
  ```

## 2. $emit事件 <Badge text="子传父" type="tip" vertical="top"/>
通过 $emit，可以实现子组件向父组件传递信息

#### 父组件

  ```Vue
  <template>
    <div>
      <Test @return="loadData" /><!-- 传递值 -->
    </div>
  </template>
  <script>
  import Test from "../components/Test.vue"; // 引入子组件
  export default {
    name: "about",
    components: { Test }, // 注册子组件
    methods: {
      loadData(param) {
        console.log(param); // '子组件传递过来的值'
      }
    }
  };
  </script>
  ```

#### 子组件

  ```Vue
  <script>
  export default {
    name: "Test",
    created() {
      this.$emit('return','子组件传递过来的值')
    },
  };
  </script>
  ```

## 3. v-model 值绑定 <Badge text="双向获取" type="tip" vertical="top"/>

`v-model`为双向传值，主要是通过两方面：prop和$emit来实现

#### 父组件
```vue
<!-- xxData和子组件里的customValue的属性值可以不一样 -->
<Test v-model="xxData" info="测试"/>
```

#### 子组件

```Vue
<script>
export default {
  name: "Test",
  props: ['customValue'],
  model: {
    prop: 'customValue',
    event: 'update'
  },
  created() {
    this.$emit('update', newCustomValue) // 当值发生变化时，抛出事件触发更新
  },
};
</script>
```
## 4. $refs <Badge text="父获取子" type="tip" vertical="top"/>

通过该属性可以获取已经标记`ref='xxx'`的子组件，通过`this.$refs.xxx`来访问对应的属性和方法。

## 5. $children <Badge text="父获取子" type="tip" vertical="top"/>

可以通过该属性获取子组件的集合（列表），根据下标 index 来获取想操作的子组件。

```js
this.$children[index].xxxx;
```


## 6. $parent <Badge text="子获取父" type="tip" vertical="top"/>

通过该属性可以访问父组件的属性和方法

```js
this.$parent.getQuery();
this.$parent.xxxxx;
```

## 7. `provide` 和 `inject`隔代注入 <Badge text="父传子" type="tip" vertical="top"/> <Badge text="Vue3" type="tip" vertical="top"/>

实现父组件向子孙孙组件传值。(层级不限，跨越层级)，父组件通过`provide`提供信息，后代组件通过`inject`注入该信息。

#### 父组件

```js
export default {
  name: "father",
  provide() {
    return {
      titleFather: "父组件的值",
    };
  },
};
```

#### 子/孙组件

```js
export default {
  name: "sonone",
  inject: ["titleFather"],
  created() {
    console.log(this.titleFather); // 父组件的值
  },
};
```
## 8. $attrs <Badge text="父传子" type="tip" vertical="top"/>
包含了父作用域中不作为 prop 被识别 (且获取) 的 attribute 绑定 (class 和 style 除外)。当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定 (class 和 style 除外)，并且可以通过 v-bind="$attrs" 传入内部组件——在创建高级别的组件时非常有用。

## 9. $listeners <Badge text="父传子" type="tip" vertical="top"/>

包含了父作用域中的 (不含 .native 修饰器的) v-on 事件监听器。它可以通过 v-on="$listeners" 传入内部组件——在创建更高层次的组件时非常有用。

## 10. EventBus 事件总线 <Badge text="随便传" type="tip" vertical="top"/>

## 11. Vuex <Badge text="随便传" type="tip" vertical="top"/>
